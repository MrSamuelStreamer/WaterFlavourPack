<?xml version="1.0" encoding="utf-8" ?>
<Defs>
    <IncidentDef ParentName="GiveQuestBase">
        <defName>MSS_GiveQuest_EndGame_WaterVictory</defName>
        <label>water victory</label>
        <letterLabel>water victory</letterLabel>
        <questScriptDef>MSS_EndGame_WaterVictory</questScriptDef>
        <baseChance>0</baseChance> <!-- given by a special storyteller comp -->
    </IncidentDef>

    <IncidentDef ParentName="GiveQuestBase">
        <defName>MSS_GiveQuest_EndGame_WaterVictory_Pre</defName>
        <label>water victory</label>
        <letterLabel>water victory</letterLabel>
        <questScriptDef>MSS_EndGame_WaterVictory_Pre</questScriptDef>
        <baseChance>0</baseChance> <!-- given by a special storyteller comp -->
    </IncidentDef>


    <!-- Archonexus subquests -->
    <QuestScriptDef Abstract="True" Name="MSS_EndGame_WaterVictory_Cycle">
        <isRootSpecial>true</isRootSpecial>
        <hideOnCleanup>true</hideOnCleanup>
        <endOnColonyMove>false</endOnColonyMove>
        <sendAvailableLetter>false</sendAvailableLetter>
        <defaultChallengeRating>4</defaultChallengeRating>
        <questNameRules>
            <rulesStrings>
                <li>questName->ab aqua libertas</li>
            </rulesStrings>
        </questNameRules>
    </QuestScriptDef>

    <!-- Hidden quest that generates the subquests below -->
    <QuestScriptDef>
        <defName>MSS_EndGame_WaterVictory_Pre</defName>
        <isRootSpecial>true</isRootSpecial>
        <defaultHidden>true</defaultHidden>
        <autoAccept>true</autoAccept>
        <endOnColonyMove>false</endOnColonyMove>
        <questNameRules>
            <rulesStrings>
                <li>questName-></li>
            </rulesStrings>
        </questNameRules>
        <questDescriptionRules>
            <rulesStrings>
                <li>questDescription-></li>
            </rulesStrings>
        </questDescriptionRules>
        <root Class="Thirst_Flavour_Pack.VictoryQuest.PreQuest.QuestNode_Root_WaterVictoryPre" />
    </QuestScriptDef>


    <QuestScriptDef>
        <defName>MSS_EndGame_WaterVictory_PreCycle</defName>
        <sendAvailableLetter>true</sendAvailableLetter>
        <affectedByPoints>false</affectedByPoints>
        <isRootSpecial>true</isRootSpecial>
        <hideOnCleanup>true</hideOnCleanup>
        <endOnColonyMove>false</endOnColonyMove>
        <defaultChallengeRating>4</defaultChallengeRating>
        <questNameRules>
            <rulesStrings>
                <li>questName->sic itur ad aquas</li>
            </rulesStrings>
        </questNameRules>
        <questDescriptionRules>
            <rulesStrings>
                <!-- description -->
                <li>questDescription->You've heard rumours about an archotech Power Regulator. The murmerings seem to hint at something related to water. Some think that it may be contributing to the lack of water. Some think it's a cure. Nobody really knows. Maybe you'll find one, and maybe you'll find answers.</li>
            </rulesStrings>
        </questDescriptionRules>
        <root Class="Thirst_Flavour_Pack.VictoryQuest.PreQuest.QuestNode_Root_WaterVictory_PreCycle" />
    </QuestScriptDef>

    <QuestScriptDef>
        <defName>MSS_EndGame_WaterVictory</defName>
        <isRootSpecial>true</isRootSpecial>
        <defaultHidden>true</defaultHidden>
        <autoAccept>true</autoAccept>
        <endOnColonyMove>false</endOnColonyMove>
        <questNameRules>
            <rulesStrings>
                <li>questName-></li>
            </rulesStrings>
        </questNameRules>
        <questDescriptionRules>
            <rulesStrings>
                <li>questDescription-></li>
            </rulesStrings>
        </questDescriptionRules>
        <root Class="Thirst_Flavour_Pack.VictoryQuest.QuestNode_Root_WaterVictory" />
    </QuestScriptDef>

  <QuestScriptDef ParentName="MSS_EndGame_WaterVictory_Cycle">
    <defName>MSS_EndGame_WaterVictory_FirstCycle</defName>
    <sendAvailableLetter>true</sendAvailableLetter>
    <affectedByPoints>false</affectedByPoints>
    <questDescriptionRules>
      <rulesStrings>
        <!-- description -->
        <li>questDescription->Having erected one of the power regulators, the colonists notice some strange earth movements in [playerSettlements]. After some investigation, it's found that archotech mechanites from deep within the planets crust have constructed connections to the power regulator from somewhere as of yet unknown. \n\nIt's noted that the mechanites are emmitting a signal, but it appears to only be a partial signal. One of the smarter colonists suggests that maybe constructing two more power regulators will be enough to complete the signal.\n\nThey do note that the increased mechanite activity underground could cause destabilization of the area. So be prepared!</li>
      </rulesStrings>
    </questDescriptionRules>
    <root Class="Thirst_Flavour_Pack.VictoryQuest.QuestNode_Root_WaterVictory_FirstCycle" />
  </QuestScriptDef>

  <QuestScriptDef ParentName="MSS_EndGame_WaterVictory_Cycle">
    <defName>MSS_EndGame_WaterVictory_SecondCycle</defName>
    <affectedByPoints>false</affectedByPoints>
    <questDescriptionRules>
      <rulesStrings>
        <!-- description -->
        <li>questDescription-> After escaping from your last colony and regrouping, you begin to analyze the data you recorded. It appears to be part of a map.\n\nAlongside the map, there's scattered references to a great drought, interspersed with references to a grand archotech machine. It appears the two may be related, but you do not yet know how.\n\nThe data also described a set of Catalytic Separators, 3 of which are required for the grand machination. Maybe you'll be able to find them now that you know what you're looking for?</li>
      </rulesStrings>
    </questDescriptionRules>
    <root Class="Thirst_Flavour_Pack.VictoryQuest.QuestNode_Root_WaterVictory_SecondCycle" />
  </QuestScriptDef>

  <QuestScriptDef ParentName="MSS_EndGame_WaterVictory_Cycle">
    <defName>MSS_EndGame_WaterVictory_ThirdCycle</defName>
    <questDescriptionRules>
      <rulesStrings>
        <li>questDescription-></li><!-- dynamic in quest -->
      </rulesStrings>
    </questDescriptionRules>
    <questContentRules>
      <rulesStrings>

        <!-- letters -->
        <li>questAcceptedLetterLabel-> archospring discovered</li>
        <li>questAcceptedLetterText->[questDescriptionBeforeAccepted]</li>

        <!-- quest descriptions -->
        <li>questDescriptionBeforeAccepted-> You escape just in time, yet again. You do now have two pieces of a map, and yet more data. Based on this new data, you're pretty sure that the archotech machine was an attempt to fix the drought, that was never completed. Some sporadic logs talk of a great war that tore nations apart, and ravaged the climate of this planet. In its wake, some survivors took it upon themselves to try to fix things. While they got much work done, squabbles over resources, especially what water was available eventually tore the group apart. The data also reveals that a set of Sterilization Plants are the last parts required for the machine.\n\nWill you go looking for the parts?</li>
        <li>questDescriptionAfterAccepted-> You escape just in time, yet again. You do now have two pieces of a map, and yet more data. Based on this new data, you're pretty sure that the archotech machine was an attempt to fix the drought, that was never completed. Some sporadic logs talk of a great war that tore nations apart, and ravaged the climate of this planet. In its wake, some survivors took it upon themselves to try to fix things. While they got much work done, squabbles over resources, especially what water was available eventually tore the group apart. The data also reveals that a set of Sterilization Plants are the last parts required for the machine.\n\nTime to start looking!\n\n[descriptionThreats]</li>

        <li>descriptionThreats(threatsEnabled==true)->The archospring will likely have defenders, so go prepared.\n\n</li>
        <li>descriptionThreats(threatsEnabled==false)-></li>

      </rulesStrings>
    </questContentRules>
    <root Class="Thirst_Flavour_Pack.VictoryQuest.QuestNode_Root_WaterVictory_ThirdCycle" />
  </QuestScriptDef>

</Defs>
