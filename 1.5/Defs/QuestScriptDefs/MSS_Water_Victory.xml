<?xml version="1.0" encoding="utf-8" ?>
<Defs>
    <IncidentDef ParentName="GiveQuestBase">
        <defName>MSS_GiveQuest_EndGame_WaterVictory</defName>
        <label>water victory</label>
        <letterLabel>water victory</letterLabel>
        <questScriptDef>MSS_EndGame_WaterVictory</questScriptDef>
        <baseChance>0</baseChance> <!-- given by a special storyteller comp -->
    </IncidentDef>

    <IncidentDef ParentName="GiveQuestBase">
        <defName>MSS_GiveQuest_EndGame_WaterVictory_Pre</defName>
        <label>water victory</label>
        <letterLabel>water victory</letterLabel>
        <questScriptDef>MSS_EndGame_WaterVictory_Pre</questScriptDef>
        <baseChance>0</baseChance> <!-- given by a special storyteller comp -->
    </IncidentDef>


    <!-- Archonexus subquests -->
    <QuestScriptDef Abstract="True" Name="MSS_EndGame_WaterVictory_Cycle">
        <isRootSpecial>true</isRootSpecial>
        <hideOnCleanup>true</hideOnCleanup>
        <endOnColonyMove>false</endOnColonyMove>
        <sendAvailableLetter>false</sendAvailableLetter>
        <defaultChallengeRating>4</defaultChallengeRating>
        <questNameRules>
            <rulesStrings>
                <li>questName->the water generator</li>
            </rulesStrings>
        </questNameRules>
    </QuestScriptDef>

    <!-- Hidden quest that generates the subquests below -->
    <QuestScriptDef>
        <defName>MSS_EndGame_WaterVictory_Pre</defName>
        <isRootSpecial>true</isRootSpecial>
        <defaultHidden>true</defaultHidden>
        <autoAccept>true</autoAccept>
        <endOnColonyMove>false</endOnColonyMove>
        <questNameRules>
            <rulesStrings>
                <li>questName-></li>
            </rulesStrings>
        </questNameRules>
        <questDescriptionRules>
            <rulesStrings>
                <li>questDescription-></li>
            </rulesStrings>
        </questDescriptionRules>
        <root Class="Thirst_Flavour_Pack.VictoryQuest.PreQuest.QuestNode_Root_WaterVictoryPre" />
    </QuestScriptDef>


    <QuestScriptDef ParentName="MSS_EndGame_WaterVictory_Cycle">
        <defName>MSS_EndGame_WaterVictory_PreCycle</defName>
        <sendAvailableLetter>true</sendAvailableLetter>
        <affectedByPoints>false</affectedByPoints>
        <questDescriptionRules>
            <rulesStrings>
                <!-- description -->
                <li>questDescription->You've heard rumours about an archotech Power Regulator. The murmerings seem to hint at something related to water. Some think that it may be contributing to the lack of water. Some think it's a cure. Nobody really knows. Maybe you'll find one, and maybe you'll find answers.</li>
            </rulesStrings>
        </questDescriptionRules>
        <root Class="Thirst_Flavour_Pack.VictoryQuest.PreQuest.QuestNode_Root_WaterVictory_PreCycle" />
    </QuestScriptDef>

    <QuestScriptDef>
        <defName>MSS_EndGame_WaterVictory</defName>
        <isRootSpecial>true</isRootSpecial>
        <defaultHidden>true</defaultHidden>
        <autoAccept>true</autoAccept>
        <endOnColonyMove>false</endOnColonyMove>
        <questNameRules>
            <rulesStrings>
                <li>questName-></li>
            </rulesStrings>
        </questNameRules>
        <questDescriptionRules>
            <rulesStrings>
                <li>questDescription-></li>
            </rulesStrings>
        </questDescriptionRules>
        <root Class="Thirst_Flavour_Pack.VictoryQuest.QuestNode_Root_WaterVictory" />
    </QuestScriptDef>

  <QuestScriptDef ParentName="MSS_EndGame_WaterVictory_Cycle">
    <defName>MSS_EndGame_WaterVictory_FirstCycle</defName>
    <sendAvailableLetter>true</sendAvailableLetter>
    <affectedByPoints>false</affectedByPoints>
    <questDescriptionRules>
      <rulesStrings>
        <!-- description -->
        <li>questDescription->Having erected one of the power regulators, the colonists notice some strange earth movements in [playerSettlements]. After some investigation, it's found that archotech mechanites from deep within the planets crust have constructed connections to the power regulator from somewhere as of yet unknown. \n\nIt's noted that the mechanites are emmitting a signal, but it appears to only be a partial signal. One of the smarter colonists suggests that maybe constructing two more power regulators will be enough to complete the signal.\n\nThey do note that the increased mechanite activity underground could cause destabilization of the area. So be prepared!</li>
      </rulesStrings>
    </questDescriptionRules>
    <root Class="Thirst_Flavour_Pack.VictoryQuest.QuestNode_Root_WaterVictory_FirstCycle" />
  </QuestScriptDef>

  <QuestScriptDef ParentName="MSS_EndGame_WaterVictory_Cycle">
    <defName>MSS_EndGame_WaterVictory_SecondCycle</defName>
    <affectedByPoints>false</affectedByPoints>
    <questDescriptionRules>
      <rulesStrings>

        <!-- description -->
        <li>questDescription-> [WATERTODO] With the first archonexus map part securely recorded, you prepare for the next step of your journey.\n\n[cycle1Faction] told you of the cataclysm that destroyed this world. Humans built a great thinking machine here centuries ago. It turned against the people and there was a great war. Only a few were left when the machine transcended and fell dormant.\n\nThe map to the archonexus has three parts, and you hold one of them. [otherMapPartHolders] also each hold parts of the map. They'll trade their parts to you for a wealthy new colony and all of its recorded research.[descriptionStudyRequirement]\n\nIt's time to get building.</li>

        <!-- pieces -->
        <li>cycle1Faction(factionless==false)->[civilOutlander_leader_nameDef]</li>
        <li>cycle1Faction(factionless==true)->The [wildPeople]</li>

        <li>otherMapPartHolders(factionless==false)->[roughOutlander_name] and [roughTribe_name]</li>
        <li>otherMapPartHolders(factionless==true)->other [wildPeople]</li>

        <li>takeoverPawnsPlural(factionless==false)->[roughOutlander_pawnsPlural]</li>
        <li>takeoverPawnsPlural(factionless==true)->[wildPeople]</li>

        <li>wildPeople->wild people</li>

        <li>descriptionStudyRequirement(studyRequirement==true)->\n\nThe next map part is encoded in a very strange way. In order to interpret it, you must first learn more about archotechnology by studying the structure here.</li>
        <li>descriptionStudyRequirement(studyRequirement==false)-></li>

      </rulesStrings>
    </questDescriptionRules>
    <root Class="Thirst_Flavour_Pack.VictoryQuest.QuestNode_Root_WaterVictory_SecondCycle" />
  </QuestScriptDef>

  <QuestScriptDef ParentName="MSS_EndGame_WaterVictory_Cycle">
    <defName>MSS_EndGame_WaterVictory_ThirdCycle</defName>
    <questDescriptionRules>
      <rulesStrings>
        <li>questDescription-></li><!-- dynamic in quest -->
      </rulesStrings>
    </questDescriptionRules>
    <questContentRules>
      <rulesStrings>

        <!-- letters -->
        <li>questAcceptedLetterLabel->[WATERTODO] archonexus discovered</li>
        <li>questAcceptedLetterText->[questDescriptionBeforeAccepted]</li>

        <!-- quest descriptions -->
        <li>questDescriptionBeforeAccepted-> [WATERTODO] You have two parts of the archonexus map. [factionName] have the last piece of the map, passed down from the time their ancestors survived the cataclysm. They'll trade it to you for a wealthy new colony along with its recorded research.[descriptionStudyRequirement]\n\nIt's time to get building.</li>
        <li>questDescriptionAfterAccepted->[descriptionIntro] [WATERTODO]  have given you the last part of the archonexus map. Using your knowledge of archotech info-encoding, you have decoded the map and pinpointed the location of the archonexus.\n\nYour allies don't expect you to return, so after you go there, they will take over [playerSettlements].\n\n[descriptionThreats]Now all that's left is to get to the archonexus, invoke the power of the machine god, and find out whether the stories are real.</li>

        <!-- pieces -->
        <li>factionName(factionless==false)->[roughTribe_name]</li>
        <li>factionName(factionless==true)->The wild people</li>

        <li>descriptionIntro(factionless==false)->[roughTribe_name]'s leader [roughTribe_leader_nameDef] has</li>
        <li>descriptionIntro(factionless==true)->The wild people have</li>

        <li>descriptionStudyRequirement(studyRequirement==true)->\n\nAs before, the map part is encoded. In order to decode it, you must first study the archotech structure.</li>
        <li>descriptionStudyRequirement(studyRequirement==false)-></li>

        <li>descriptionThreats(threatsEnabled==true)->The archonexus will likely have mechanoid defenders, so go prepared.\n\n</li>
        <li>descriptionThreats(threatsEnabled==false)-></li>

      </rulesStrings>
    </questContentRules>
    <root Class="Thirst_Flavour_Pack.VictoryQuest.QuestNode_Root_WaterVictory_ThirdCycle" />
  </QuestScriptDef>

</Defs>
